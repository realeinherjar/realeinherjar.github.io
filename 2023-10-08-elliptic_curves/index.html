<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>What the hell is an Elliptic Curve? | Einherjar</title><meta name=keywords content="cryptography,bitcoin"><meta name=description content="Warning: This post has KaTeX enabled, so if you want to view the rendered math formulas, you&rsquo;ll have to unfortunately enable JavaScript.
Note: All elliptic curve images are made using $\LaTeX$ and TikZ. The source code is freely available at GitHub.
What the hell is an Elliptic Curve? In this post, I&rsquo;ll try to explain what an elliptic curve is, and why it&rsquo;s so important in cryptography. If you ever used an end-to-end encrypted messaging app, or hold Bitcoin (or any other shitcoin, though I don&rsquo;t recommend it), you&rsquo;ve probably heard of elliptic curves."><meta name=author content="Einherjar"><link rel=canonical href=https://realeinherjar.github.io/2023-10-08-elliptic_curves/><link crossorigin=anonymous href=/assets/css/stylesheet.857f9fea0402425c5de58e9bd520d541b58a979a2ee014453c6d6b69c2ba3aec.css integrity="sha256-hX+f6gQCQlxd5Y6b1SDVQbWKl5ou4BRFPG1racK6Ouw=" rel="preload stylesheet" as=style><noscript><link crossorigin=anonymous href=/css/includes/noscript.30127fa68e36d08f5dd7f9d4e717dac42e729b844672afd0fbcacb0d9e508595.css integrity="sha256-MBJ/po420I9d1/nU5xfaxC5ym4RGcq/Q+8rLDZ5QhZU=" rel="preload stylesheet" as=style></noscript><link rel=icon href=https://realeinherjar.github.io/assets/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://realeinherjar.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://realeinherjar.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://realeinherjar.github.io/apple-touch-icon.png><link rel=mask-icon href=https://realeinherjar.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css integrity=sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0 crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js integrity=sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4 crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous onload=renderMathInElement(document.body)></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><meta property="og:title" content="What the hell is an Elliptic Curve?"><meta property="og:description" content="Warning: This post has KaTeX enabled, so if you want to view the rendered math formulas, you&rsquo;ll have to unfortunately enable JavaScript.
Note: All elliptic curve images are made using $\LaTeX$ and TikZ. The source code is freely available at GitHub.
What the hell is an Elliptic Curve? In this post, I&rsquo;ll try to explain what an elliptic curve is, and why it&rsquo;s so important in cryptography. If you ever used an end-to-end encrypted messaging app, or hold Bitcoin (or any other shitcoin, though I don&rsquo;t recommend it), you&rsquo;ve probably heard of elliptic curves."><meta property="og:type" content="article"><meta property="og:url" content="https://realeinherjar.github.io/2023-10-08-elliptic_curves/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-01T16:08:15-03:00"><meta property="article:modified_time" content="2023-10-06T07:38:31-03:00"><meta property="og:site_name" content="Einherjar"><meta name=twitter:card content="summary"><meta name=twitter:title content="What the hell is an Elliptic Curve?"><meta name=twitter:description content="Warning: This post has KaTeX enabled, so if you want to view the rendered math formulas, you&rsquo;ll have to unfortunately enable JavaScript.
Note: All elliptic curve images are made using $\LaTeX$ and TikZ. The source code is freely available at GitHub.
What the hell is an Elliptic Curve? In this post, I&rsquo;ll try to explain what an elliptic curve is, and why it&rsquo;s so important in cryptography. If you ever used an end-to-end encrypted messaging app, or hold Bitcoin (or any other shitcoin, though I don&rsquo;t recommend it), you&rsquo;ve probably heard of elliptic curves."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog","item":"https://realeinherjar.github.io/posts/"},{"@type":"ListItem","position":2,"name":"What the hell is an Elliptic Curve?","item":"https://realeinherjar.github.io/2023-10-08-elliptic_curves/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"What the hell is an Elliptic Curve?","name":"What the hell is an Elliptic Curve?","description":"Warning: This post has KaTeX enabled, so if you want to view the rendered math formulas, you\u0026rsquo;ll have to unfortunately enable JavaScript.\nNote: All elliptic curve images are made using $\\LaTeX$ and TikZ. The source code is freely available at GitHub.\nWhat the hell is an Elliptic Curve? In this post, I\u0026rsquo;ll try to explain what an elliptic curve is, and why it\u0026rsquo;s so important in cryptography. If you ever used an end-to-end encrypted messaging app, or hold Bitcoin (or any other shitcoin, though I don\u0026rsquo;t recommend it), you\u0026rsquo;ve probably heard of elliptic curves.","keywords":["cryptography","bitcoin"],"articleBody":" Warning: This post has KaTeX enabled, so if you want to view the rendered math formulas, you’ll have to unfortunately enable JavaScript.\nNote: All elliptic curve images are made using $\\LaTeX$ and TikZ. The source code is freely available at GitHub.\nWhat the hell is an Elliptic Curve? In this post, I’ll try to explain what an elliptic curve is, and why it’s so important in cryptography. If you ever used an end-to-end encrypted messaging app, or hold Bitcoin (or any other shitcoin, though I don’t recommend it), you’ve probably heard of elliptic curves. It is important to know that elliptic curves are not only used in cryptography, but also in many other fields of mathematics, such as number theory, algebraic geometry, and topology.\nMy main argument is that elliptic curves are not that hard to understand. Additionally, since encryption is ubiquitous in our daily lives, understanding them is important to be a well-informed citizen. I’ll try to explain the concepts in a simple way, but I’ll assume you have some basic knowledge of algebra and math symbols. Finally, I’ll use the standard math notation, so that when you read about elliptic curves in other places, you’ll be able to make connections more easily.\nWhat is an Elliptic Curve? An elliptic curve is a curve defined by the equation\n$$y^2 = x^3 + ax + b$$\nwhere $a$ and $b$ are real numbers.\nHere’s an example of an elliptic curve, if you set $a = 0$ and $b = 7$:\n$$y^2 = x^3 + 7$$\nThis is secp256k1, the notorious elliptic curve used in Bitcoin.\nsecp256k1 curve Elliptic curves have some properties that make them interesting. For example, they are symmetric with respect to the $x$-axis. This means that if $(x, y)$ is a point in the curve, then $(x, -y)$ is also a point in the curve1. This is because $(-y)^2 = y^2$.\nAdding Points in an Elliptic Curve If you have two points $P$ and $P^\\prime$ in the curve, then the line that passes through them will intersect the curve in a third point2 $P^{\\prime\\prime}$:\nTwo Points in an Elliptic Curve If you reflect $P^{\\prime\\prime}$ with respect to the $x$-axis, you’ll get a new point:\nAdding Two Points in an Elliptic Curve This is how you add two points in an elliptic curve. Note that the result of adding two points is also a point in the curve. This property is called closure. For any two points $P$ and $P^\\prime$ in the curve, $P + P^\\prime$ is also a point in the curve.\nThere are two cases where the line doesn’t intersect the curve in a third point. The first one is when $P = P^\\prime$.\nAdding a Point to Itself in an Elliptic Curve Then we have a tangent line. In this case we take derivatives on both sides:\n$$\\begin{aligned} y^2 \u0026= x^3 + ax + b \\\\ 2y \\frac{dy}{dx} \u0026= 3x^2 + a \\\\ \\frac{dy}{dx} \u0026= \\frac{3x^2 + a}{2y} \\end{aligned}$$\nHence, $2*P = (x, y)$ where $x = \\left( \\frac{3x^2 + a}{2y} \\right) - 2x$, and $y = \\left( \\frac{3x^2 + a}{2y} \\right) (x - x) - y$.\nThe other is when $P^\\prime$ is the reflection of $P$ with respect to the $x$-axis.\nAdding a Point to Its Reflection in an Elliptic Curve Then we have a vertical line. In this case we define $P + P^\\prime = \\mathcal{O}$, where $\\mathcal{O}$ is the point at infinity.\nPoint Addition Properties Point addition satisfies some properties:\nIdentity: $P + \\mathcal{O} = \\mathcal{O} + P = P$ Commutativity: $P + P^\\prime = P^\\prime + P$ Associativity: $(P + P^\\prime) + P^{\\prime\\prime} = P + (P^\\prime + P^{\\prime\\prime})$ Inverse Element: $P + (-P) = \\mathcal{O}$ Closure: $P + P^\\prime$ is a point in the curve Hey this is very similar to addition of integers! But using points instead of integers.\nIn fact, we can define multiplication of a point $P$ by an integer $n$ as:\n$$\\underbrace{P + P + \\cdots + P}_{n \\text{ times}}$$\nAbelian Groups The set of points in an elliptic curve with the point at infinity $\\mathcal{O}$ along with a binary operation $+$ that satisfies the properties above is called an Abelian group. In honor of Niels Henrik Abel, an Abelian group is a set with a binary operation that satisfies all the properties above.\nAnother example of an Abelian group is the set of integers $\\mathbb{Z}$ with addition $+$. And another one is the set of natural numbers $\\mathbb{N}$ with multiplication $\\times$.\nFields There’s one more concept that we need to learn before we can talk about cryptography. It’s called a finite field. But before we talk about finite fields, we need to first define a field. Fields are sets with two binary operations, called addition $+$ and multiplication $\\times$. We write\n$$F = (F, +, \\times)$$\nto denote a field, where $F$ is the set, $+$ is the addition operation, and $\\times$ is the multiplication operation.\nAddition and multiplication behave similar to the addition and multiplication of real numbers. For example, addition is commutative and associative\n$$a + b = b + a,$$\nand multiplication is distributive\n$$a \\times (b + c) = a \\times b + a \\times c.$$\nAlso, there are two special elements in the field, called the additive identity $-a$ and the multiplicative identity $a^{-1}$, such that\n$$a + (-a) = I,$$\nand\n$$a \\times a^{-1} = I,$$\nwhere $I$ is the identity element.\nNote that this allows us to define subtraction\n$$a - b = a + (-b),$$\nand division\n$$a \\div b = a \\times b^{-1}.$$\nFinite Fields Now we are ready for finite fields. A finite field, also called a Galois field (in honor of Évariste Galois), is a field with a finite number of elements. As with any field, a finite field is a set on which the operations of multiplication, addition, subtraction and division are defined and satisfy the rules above for fields.\nFinite fields is a very rich topic in mathematics, and there are many ways to construct them. The easiest way to construct a finite field is to take the integers modulo a prime number $p$. For example $\\mathbb{Z}_4$ is a finite field with 4 elements:\n$$\\mathbb{Z}_4 = \\lbrace 0, 1, 2, 3 \\rbrace.$$\nIn general, $\\mathbb{Z}_n$ is a finite field with $n$ elements:\n$$\\mathbb{Z}_n = \\lbrace 0, 1, 2, \\ldots, n - 1 \\rbrace.$$\nThe number of elements in a finite field is called the order of the field. The order of a finite field is always a prime number $p$. The $\\mathbb{Z}_4$ example above is a finite field of order 2. To see that notice that $4$ is a composite number,\n$$4 = 2 \\times 2.$$\nAnd we can write $\\mathbb{Z}_4$ as\n$$\\mathbb{Z}_4 = 2 \\times \\mathbb{Z}_2.$$\nThis means that every element in $a \\in \\mathbb{Z}_4$ can be written as\n$$a = 2 \\times b,$$\nwhere $b$ is an element in $\\mathbb{Z}_2$.\nHence, not every element of $\\mathbb{Z}_4$ is unique, and they are equivalent to the elements in $\\mathbb{Z}_2$.\nIn general if $n$ is a composite number, then $\\mathbb{Z}_n$ is not a finite field. However, if $n = r \\times s$ where $r$ and $s$ are prime numbers, and $r \u003c s$, then $\\mathbb{Z}_n$ is a finite field of order $r$.\nOperations in Finite Fields Addition in finite fields is defined as the remainder of the sum of two elements modulo the order of the field.\nFor example, in $\\mathbb{Z}_3$,\n$$1 + 2 = 3 \\mod 3 = 0.$$\nWe can also define subtraction in finite fields as the remainder of the difference of two elements modulo the order of the field.\nFor example, in $\\mathbb{Z}_3$,\n$$1 - 2 = -1 \\mod 3 = 2.$$\nMultiplication in finite fields can be written as multiple additions. For example, in $\\mathbb{Z}_3$,\n$$2 \\times 2 = 2 + 2 = 4 \\mod 3 = 1.$$\nExponentiation in finite fields can be written as multiple multiplications. For example, in $\\mathbb{Z}_3$,\n$$2^2 = 2 \\times 2 = 4 \\mod 3 = 1.$$\nThis is very trivial for any finite field. However, for division we are pretty much screwed. It is really hard to find the multiplicative inverse of an element in a finite field. For example, suppose that we have numbers $a,b$ in a very large finite field $\\mathbb{Z}_n$, such that\n$$c = a \\times b \\mod n.$$\nThen we can write division as\n$$a = c \\div b = c \\times b^{-1} \\mod n.$$\nNow we need to find $b^{-1}$. This is called the discrete logarithm problem. Because we need to find the exponent $b^{-1}$ such that\n$$b^{-1} = \\log_b c \\mod n.$$\nSince this number is a discrete number and not a real number, that’s why it’s called the discrete logarithm problem.\nGood luck my friend, no efficient method is known for computing them in general. You can try brute force, but that’s not efficient.\nWhy the Discrete Logarithm Problem is Hard as Fuck To get a feeling why the discrete logarithm problem is difficult, let’s add one more concept to our bag of knowledge. Every finite field has generators, also known as primitive roots, which is also a member of the group, such that applying multiplication to this one single element makes possible to generate the whole finite field.\nLet’s illustrate this with an example. Below we have a table of all the results of the following operation\n$$b^x \\mod 7$$\nfor every possible value of $x$. As you’ve guessed right this is the $\\mathbb{Z}_7$ finite field.\n$b$ $b^1 \\mod 7$ $b^2 \\mod 7$ $b^3 \\mod 7$ $b^4 \\mod 7$ $b^5 \\mod 7$ $b^6 \\mod 7$ $1$ $1$ $1$ $1$ $1$ $1$ $1$ $2$ $2$ $4$ $1$ $2$ $4$ $1$ $3$ $3$ $2$ $6$ $4$ $5$ $1$ $4$ $4$ $2$ $1$ $4$ $2$ $1$ $5$ $5$ $4$ $6$ $2$ $3$ $1$ $6$ $6$ $1$ $6$ $1$ $1$ $1$ You see that something interesting is happening here. For specific values of $b$, such as $b = 3$, and $b = 5$, we are able to generate the whole finite field. Hence, say that $3$ and $5$ are generators or primitive roots of $\\mathbb{Z}_7$.\nNow suppose I ask you to find $x$ in the following equation\n$$3^x \\mod p = 11$$\nwhere $p$ is a very large prime number. Then you don’t have any other option than brute forcing it. You’ll need to try each exponent $x$ until you find the one that satisfies the equation.\nNotice that this operation is very asymmetric. It is very easy to compute $3^x \\mod p$ for any $x$, but it is very hard to find $x$ given $3^x \\mod p$.\nBringing it All Together Now we are ready to talk about elliptic curve cryptography. Elliptic curve cryptography is a public-key encryption technique based on elliptic curves. It is used to create public and private keys for asymmetric cryptography.\nYour private key is a random number $k$. Your public key is the point $kG$ in the elliptic curve, where $G$ is a point and a generator of the elliptic curve. We know that $kG$ is a point in the elliptic curve, because elliptic curves are Abelian groups, having the closure property, then\n$$kG = \\underbrace{G + G + \\cdots + G}_{k \\text{ times}}$$\nis also a point in the elliptic curve.\nNow here comes the grand finale. Since elliptic curves are finite fields, then we can use the discrete logarithm problem to our advantage. It is very easy to compute $kG$ given $k$ and $G$. But it is hard as fuck to find $k$ given $kG$ and $G$.\nThe secp256k1 Elliptic Curve Let’s talk about some facts3 about our muse secp256k1 elliptic curve:\nEquation: $y^2 = x^3 + 7$ $\\mathbb{F}_p$ where $p$: $2^{256} - 2^{32} - 2^9 - 2^8 - 2^7 - 2^6 - 2^4 - 1$ (yes, it is a prime number) Order $n$: this is the number of possible points in the curve4, 0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd03641415 Generator Point $G$: (0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798, 0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8)5 License This post is licensed under Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International.\nThis is also why transaction malleability was a problem before Segwit in Bitcoin. ↩︎\nIf the line is vertical or tangent to the curve, then it intersects the curve in a point at infinity. ↩︎\nThese are standard and defined in the Standards for Efficient Cryptography Group in their SEC 2 specification. ↩︎\nTo find the order of an elliptic curve, you can use Schoof’s algorithm. ↩︎\nIt is a fucking big number, so I am putting the values in hexadecimal representation. ↩︎ ↩︎\n","wordCount":"2080","inLanguage":"en","datePublished":"2023-10-01T16:08:15-03:00","dateModified":"2023-10-06T07:38:31-03:00","author":{"@type":"Person","name":"Einherjar"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://realeinherjar.github.io/2023-10-08-elliptic_curves/"},"publisher":{"@type":"Organization","name":"Einherjar","logo":{"@type":"ImageObject","url":"https://realeinherjar.github.io/assets/favicon.ico"}}}</script></head><body class=dark id=top><script crossorigin=anonymous src=/assets/js/theme.b20f95bb4da41ef90a2610a557a7000b2649a3f47282ec571676da6fc0427200.js integrity="sha256-sg+Vu02kHvkKJhClV6cACyZJo/RyguxXFnbab8BCcgA="></script><header class=header><div id=progressBar></div><nav class=nav><div class=logo><a href=https://realeinherjar.github.io/ accesskey=h title="Einherjar (Alt + H)">Einherjar</a><div class=logo-switches><button type=button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><input name=hamburger-input id=hamburger-input type=checkbox aria-label="Navigation Menu">
<label id=hamburger-menu for=hamburger-input></label><div class=overlay></div><ul id=menu><li><a href=https://realeinherjar.github.io/about title=About><span>About</span></a></li><li><a href=https://realeinherjar.github.io/posts/ title=Blog><span>Blog</span></a></li><li><a href=https://realeinherjar.github.io/privacy/ title="Privacy Basics"><span>Privacy Basics</span></a></li><li><a href=https://realeinherjar.github.io/categories/bitcoin-basics title="Bitcoin Basics"><span>Bitcoin Basics</span></a></li><li><a href=https://realeinherjar.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://realeinherjar.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://realeinherjar.github.io/posts/>Blog</a></div><h1 class=post-title>What the hell is an Elliptic Curve?</h1><div class=post-meta><span title='2023-10-01 16:08:15 -0300 -0300'>October 1, 2023</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp;Einherjar&nbsp;|&nbsp;<a href=https://github.com/realeinherjar/realeinherjar.github.io/blob/main/content/posts/2023-10-08-elliptic_curves/index.md rel="noopener noreferrer">Source code</a></div><div class=post-meta><span title="2023-10-06 07:38:31 -0300 -0300"><i>Last updated on October 6, 2023</i></span></div></header><div class="toc side"><details id=toc><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#what-is-an-elliptic-curve aria-label="What is an Elliptic Curve?">What is an Elliptic Curve?</a><ul><li><a href=#adding-points-in-an-elliptic-curve aria-label="Adding Points in an Elliptic Curve">Adding Points in an Elliptic Curve</a></li><li><a href=#point-addition-properties aria-label="Point Addition Properties">Point Addition Properties</a></li><li><a href=#abelian-groups aria-label="Abelian Groups">Abelian Groups</a></li></ul></li><li><a href=#fields aria-label=Fields>Fields</a><ul><li><a href=#finite-fields aria-label="Finite Fields">Finite Fields</a><ul><li><a href=#operations-in-finite-fields aria-label="Operations in Finite Fields">Operations in Finite Fields</a><ul><li><a href=#why-the-discrete-logarithm-problem-is-hard-as-fuck aria-label="Why the Discrete Logarithm Problem is Hard as Fuck">Why the Discrete Logarithm Problem is Hard as Fuck</a></li></ul></li></ul></li></ul></li><li><a href=#bringing-it-all-together aria-label="Bringing it All Together">Bringing it All Together</a></li><li><a href=#the-secp256k1-elliptic-curve aria-label="The secp256k1 Elliptic Curve">The <code>secp256k1</code> Elliptic Curve</a></li><li><a href=#license aria-label=License>License</a></li></ul></div></details></div><div class=post-content><blockquote><p>Warning: This post has <a href=https://katex.org/>KaTeX</a> enabled,
so if you want to view the rendered math formulas,
you&rsquo;ll have to unfortunately enable JavaScript.</p><p>Note: All elliptic curve images are made using $\LaTeX$ and TikZ.
The source code is freely available at <a href=https://gist.github.com/realeinherjar/84061e78c85e08476f373e77c5a652ac>GitHub</a>.</p></blockquote><p>What the hell is an Elliptic Curve?
In this post, I&rsquo;ll try to explain what an elliptic curve is,
and why it&rsquo;s so important in cryptography.
If you ever used an end-to-end encrypted messaging app,
or hold Bitcoin (or any other shitcoin, though I don&rsquo;t recommend it),
you&rsquo;ve probably heard of elliptic curves.
It is important to know that elliptic curves are not only used in cryptography,
but also in many other fields of mathematics,
such as number theory, algebraic geometry, and topology.</p><p>My main argument is that elliptic curves are not that hard to understand.
Additionally, since encryption is ubiquitous in our daily lives,
<strong>understanding them is important to be a well-informed citizen</strong>.
I&rsquo;ll try to explain the concepts in a simple way,
but I&rsquo;ll assume you have some basic knowledge of algebra and math symbols.
Finally, I&rsquo;ll use the standard math notation,
so that when you read about elliptic curves in other places,
you&rsquo;ll be able to make connections more easily.</p><h2 id=what-is-an-elliptic-curve>What is an Elliptic Curve?<a hidden class=anchor aria-hidden=true href=#what-is-an-elliptic-curve>#</a></h2><p><strong>An <a href=https://en.wikipedia.org/wiki/Elliptic_curve><em>elliptic curve</em></a> is a curve defined by the equation</strong></p><p>$$y^2 = x^3 + ax + b$$</p><p>where $a$ and $b$ are real numbers.</p><p>Here&rsquo;s an example of an elliptic curve,
if you set $a = 0$ and $b = 7$:</p><p>$$y^2 = x^3 + 7$$</p><p><strong>This is <a href=https://en.bitcoin.it/wiki/Secp256k1><code>secp256k1</code></a>,
the notorious elliptic curve used in Bitcoin</strong>.</p><figure><img loading=lazy src=ec.png><figcaption>secp256k1 curve</figcaption></figure><p>Elliptic curves have some properties that make them interesting.
For example, they are <strong>symmetric with respect to the $x$-axis</strong>.
This means that if $(x, y)$ is a point in the curve,
then $(x, -y)$ is also a point in the curve<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.
This is because $(-y)^2 = y^2$.</p><h3 id=adding-points-in-an-elliptic-curve>Adding Points in an Elliptic Curve<a hidden class=anchor aria-hidden=true href=#adding-points-in-an-elliptic-curve>#</a></h3><p>If you have two points $P$ and $P^\prime$ in the curve,
then the line that passes through them will intersect the curve in a third point<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>
$P^{\prime\prime}$:</p><figure><img loading=lazy src=ec_point.png><figcaption>Two Points in an Elliptic Curve</figcaption></figure><p>If you reflect $P^{\prime\prime}$ with respect to the $x$-axis,
you&rsquo;ll get a new point:</p><figure><img loading=lazy src=ec_point_add.png><figcaption>Adding Two Points in an Elliptic Curve</figcaption></figure><p>This is how you <strong>add two points in an elliptic curve</strong>.
Note that the result of adding two points is <strong>also a point in the curve</strong>.
This property is called <em>closure</em>.
For any two points $P$ and $P^\prime$ in the curve,
$P + P^\prime$ is also a point in the curve.</p><p>There are <strong>two cases where the line doesn&rsquo;t intersect the curve in a third point</strong>.
The first one is when $P = P^\prime$.</p><figure><img loading=lazy src=ec_point_tangent.png><figcaption>Adding a Point to Itself in an Elliptic Curve</figcaption></figure><p>Then we have a tangent line.
In this case we take derivatives on both sides:</p><p>$$\begin{aligned}
y^2 &= x^3 + ax + b \\
2y \frac{dy}{dx} &= 3x^2 + a \\
\frac{dy}{dx} &= \frac{3x^2 + a}{2y}
\end{aligned}$$</p><p>Hence, $2*P = (x, y)$ where $x = \left( \frac{3x^2 + a}{2y} \right) - 2x$,
and $y = \left( \frac{3x^2 + a}{2y} \right) (x - x) - y$.</p><p>The other is when $P^\prime$ is the reflection of $P$ with respect to the $x$-axis.</p><figure><img loading=lazy src=ec_point_vertical.png><figcaption>Adding a Point to Its Reflection in an Elliptic Curve</figcaption></figure><p>Then we have a vertical line.
In this case we define $P + P^\prime = \mathcal{O}$,
where $\mathcal{O}$ is the <strong>point at infinity</strong>.</p><h3 id=point-addition-properties>Point Addition Properties<a hidden class=anchor aria-hidden=true href=#point-addition-properties>#</a></h3><p>Point addition satisfies some properties:</p><ul><li><strong>Identity</strong>: $P + \mathcal{O} = \mathcal{O} + P = P$</li><li><strong>Commutativity</strong>: $P + P^\prime = P^\prime + P$</li><li><strong>Associativity</strong>: $(P + P^\prime) + P^{\prime\prime} = P + (P^\prime + P^{\prime\prime})$</li><li><strong>Inverse Element</strong>: $P + (-P) = \mathcal{O}$</li><li><strong>Closure</strong>: $P + P^\prime$ is a point in the curve</li></ul><p>Hey this is very similar to addition of integers!
But using points instead of integers.</p><p>In fact, we can define <strong>multiplication</strong> of a point $P$ by an integer $n$ as:</p><p>$$\underbrace{P + P + \cdots + P}_{n \text{ times}}$$</p><h3 id=abelian-groups>Abelian Groups<a hidden class=anchor aria-hidden=true href=#abelian-groups>#</a></h3><p>The set of points in an elliptic curve with the point at infinity $\mathcal{O}$
along with a binary operation $+$ that satisfies the properties above is called an
<a href=https://en.wikipedia.org/wiki/Abelian_group><em>Abelian group</em></a>.
In honor of Niels Henrik Abel, an Abelian group is a <strong>set with a binary operation that
satisfies all the properties above</strong>.</p><p>Another example of an Abelian group is the set of integers $\mathbb{Z}$ with addition $+$.
And another one is the set of natural numbers $\mathbb{N}$ with multiplication $\times$.</p><h2 id=fields>Fields<a hidden class=anchor aria-hidden=true href=#fields>#</a></h2><p>There&rsquo;s one more concept that we need to learn before we can talk about cryptography.
It&rsquo;s called a finite field.
But before we talk about finite fields,
we need to first define a <strong>field</strong>.
<strong><a href=https://en.wikipedia.org/wiki/Field_(mathematics)>Fields</a> are sets with two binary operations,
called addition $+$ and multiplication $\times$</strong>.
We write</p><p>$$F = (F, +, \times)$$</p><p>to denote a field,
where $F$ is the set, $+$ is the addition operation,
and $\times$ is the multiplication operation.</p><p>Addition and multiplication behave similar to the addition and multiplication of real numbers.
For example, addition is <strong>commutative</strong> and <strong>associative</strong></p><p>$$a + b = b + a,$$</p><p>and multiplication is <strong>distributive</strong></p><p>$$a \times (b + c) = a \times b + a \times c.$$</p><p>Also, there are two special elements in the field,
called the <strong>additive identity</strong> $-a$ and the <strong>multiplicative identity</strong> $a^{-1}$,
such that</p><p>$$a + (-a) = I,$$</p><p>and</p><p>$$a \times a^{-1} = I,$$</p><p>where $I$ is the identity element.</p><p>Note that this allows us to define <strong>subtraction</strong></p><p>$$a - b = a + (-b),$$</p><p>and <strong>division</strong></p><p>$$a \div b = a \times b^{-1}.$$</p><h3 id=finite-fields>Finite Fields<a hidden class=anchor aria-hidden=true href=#finite-fields>#</a></h3><p>Now we are ready for finite fields.
A <a href=https://en.wikipedia.org/wiki/Finite_field><em>finite field</em></a>, also called a Galois field (in honor of Évariste Galois),
is a <strong>field with a finite number of elements.
As with any field, a finite field is a set on which the operations of multiplication,
addition, subtraction and division are defined and satisfy the rules above for fields</strong>.</p><p>Finite fields is a very rich topic in mathematics,
and there are many ways to construct them.
The easiest way to construct a finite field is to take the <strong>integers modulo a prime number $p$</strong>.
For example $\mathbb{Z}_4$ is a finite field with 4 elements:</p><p>$$\mathbb{Z}_4 = \lbrace 0, 1, 2, 3 \rbrace.$$</p><p>In general, $\mathbb{Z}_n$ is a finite field with $n$ elements:</p><p>$$\mathbb{Z}_n = \lbrace 0, 1, 2, \ldots, n - 1 \rbrace.$$</p><p><strong>The number of elements in a finite field is called the <em>order</em> of the field</strong>.
The order of a finite field is <strong>always a prime number $p$</strong>.
The $\mathbb{Z}_4$ example above is a finite field of order 2.
To see that notice that $4$ is a composite number,</p><p>$$4 = 2 \times 2.$$</p><p>And we can write $\mathbb{Z}_4$ as</p><p>$$\mathbb{Z}_4 = 2 \times \mathbb{Z}_2.$$</p><p>This means that every element in $a \in \mathbb{Z}_4$ can be written as</p><p>$$a = 2 \times b,$$</p><p>where $b$ is an element in $\mathbb{Z}_2$.</p><p>Hence, not every element of $\mathbb{Z}_4$ is unique, and they are equivalent to the elements in $\mathbb{Z}_2$.</p><p>In general if $n$ is a composite number,
then $\mathbb{Z}_n$ is not a finite field.
However, if $n = r \times s$ where $r$ and $s$ are prime numbers,
and $r &lt; s$,
then $\mathbb{Z}_n$ is a finite field of order $r$.</p><h4 id=operations-in-finite-fields>Operations in Finite Fields<a hidden class=anchor aria-hidden=true href=#operations-in-finite-fields>#</a></h4><p><strong>Addition</strong> in finite fields is defined as the remainder of the sum of two elements modulo the order of the
field.</p><p>For example, in $\mathbb{Z}_3$,</p><p>$$1 + 2 = 3 \mod 3 = 0.$$</p><p>We can also define subtraction in finite fields as the remainder of the difference of two elements modulo the order of the field.</p><p>For example, in $\mathbb{Z}_3$,</p><p>$$1 - 2 = -1 \mod 3 = 2.$$</p><p>Multiplication in finite fields can be written as multiple additions.
For example, in $\mathbb{Z}_3$,</p><p>$$2 \times 2 = 2 + 2 = 4 \mod 3 = 1.$$</p><p>Exponentiation in finite fields can be written as multiple multiplications.
For example, in $\mathbb{Z}_3$,</p><p>$$2^2 = 2 \times 2 = 4 \mod 3 = 1.$$</p><p>This is very trivial for any finite field.
However, for division we are pretty much screwed.
It is really hard to find the multiplicative inverse of an element in a finite field.
For example, suppose that we have numbers $a,b$ in a very large finite field $\mathbb{Z}_n$,
such that</p><p>$$c = a \times b \mod n.$$</p><p>Then we can write division as</p><p>$$a = c \div b = c \times b^{-1} \mod n.$$</p><p>Now we need to find $b^{-1}$.
This is called the <a href=https://en.wikipedia.org/wiki/Discrete_logarithm><strong><em>discrete logarithm problem</em></strong></a>.
Because we need to find the exponent $b^{-1}$ such that</p><p>$$b^{-1} = \log_b c \mod n.$$</p><p>Since this number is a discrete number and not a real number,
that&rsquo;s why it&rsquo;s called the discrete logarithm problem.</p><p>Good luck my friend, no efficient method is known for computing them in general.
You can try brute force, but that&rsquo;s not efficient.</p><h5 id=why-the-discrete-logarithm-problem-is-hard-as-fuck>Why the Discrete Logarithm Problem is Hard as Fuck<a hidden class=anchor aria-hidden=true href=#why-the-discrete-logarithm-problem-is-hard-as-fuck>#</a></h5><p>To get a feeling why the discrete logarithm problem is difficult,
let&rsquo;s add one more concept to our bag of knowledge.
Every finite field has <em><strong>generators</strong></em>,
also known as <em><strong>primitive roots</strong></em>,
which is also a member of the group,
such that applying multiplication to this one single element
makes possible to generate the whole finite field.</p><p>Let&rsquo;s illustrate this with an example.
Below we have a table of all the results of the following operation</p><p>$$b^x \mod 7$$</p><p>for every possible value of $x$.
As you&rsquo;ve guessed right this is the $\mathbb{Z}_7$ finite field.</p><table><thead><tr><th style=text-align:center>$b$</th><th style=text-align:center>$b^1 \mod 7$</th><th style=text-align:center>$b^2 \mod 7$</th><th style=text-align:center>$b^3 \mod 7$</th><th style=text-align:center>$b^4 \mod 7$</th><th style=text-align:center>$b^5 \mod 7$</th><th style=text-align:center>$b^6 \mod 7$</th></tr></thead><tbody><tr><td style=text-align:center>$1$</td><td style=text-align:center>$1$</td><td style=text-align:center>$1$</td><td style=text-align:center>$1$</td><td style=text-align:center>$1$</td><td style=text-align:center>$1$</td><td style=text-align:center>$1$</td></tr><tr><td style=text-align:center>$2$</td><td style=text-align:center>$2$</td><td style=text-align:center>$4$</td><td style=text-align:center>$1$</td><td style=text-align:center>$2$</td><td style=text-align:center>$4$</td><td style=text-align:center>$1$</td></tr><tr><td style=text-align:center>$3$</td><td style=text-align:center>$3$</td><td style=text-align:center>$2$</td><td style=text-align:center>$6$</td><td style=text-align:center>$4$</td><td style=text-align:center>$5$</td><td style=text-align:center>$1$</td></tr><tr><td style=text-align:center>$4$</td><td style=text-align:center>$4$</td><td style=text-align:center>$2$</td><td style=text-align:center>$1$</td><td style=text-align:center>$4$</td><td style=text-align:center>$2$</td><td style=text-align:center>$1$</td></tr><tr><td style=text-align:center>$5$</td><td style=text-align:center>$5$</td><td style=text-align:center>$4$</td><td style=text-align:center>$6$</td><td style=text-align:center>$2$</td><td style=text-align:center>$3$</td><td style=text-align:center>$1$</td></tr><tr><td style=text-align:center>$6$</td><td style=text-align:center>$6$</td><td style=text-align:center>$1$</td><td style=text-align:center>$6$</td><td style=text-align:center>$1$</td><td style=text-align:center>$1$</td><td style=text-align:center>$1$</td></tr></tbody></table><p>You see that something interesting is happening here.
For specific values of $b$, such as $b = 3$, and $b = 5$, we are able to <strong>generate the whole finite field</strong>.
Hence, say that $3$ and $5$ are <em><strong>generators</strong></em> or <em><strong>primitive roots</strong></em> of $\mathbb{Z}_7$.</p><p>Now suppose I ask you to find $x$ in the following equation</p><p>$$3^x \mod p = 11$$</p><p>where $p$ is a very large prime number.
Then you don&rsquo;t have any other option than brute forcing it.
<strong>You&rsquo;ll need to try each exponent $x$ until you find the one that satisfies the equation</strong>.</p><p>Notice that this operation is very asymmetric.
It is very easy to compute $3^x \mod p$ for any $x$,
but it is very hard to find $x$ given $3^x \mod p$.</p><h2 id=bringing-it-all-together>Bringing it All Together<a hidden class=anchor aria-hidden=true href=#bringing-it-all-together>#</a></h2><p>Now we are ready to talk about elliptic curve cryptography.
<strong>Elliptic curve cryptography is a public-key encryption technique based on elliptic curves</strong>.
It is used to create public and private keys for asymmetric cryptography.</p><p>Your <strong>private key is a random number $k$</strong>.
Your <strong>public key is the point $kG$ in the elliptic curve</strong>,
where $G$ is a point and a generator of the elliptic curve.
We know that $kG$ is a point in the elliptic curve,
because elliptic curves are Abelian groups,
having the closure property,
then</p><p>$$kG = \underbrace{G + G + \cdots + G}_{k \text{ times}}$$</p><p>is also a point in the elliptic curve.</p><p>Now here comes the grand finale.
Since elliptic curves are finite fields,
then we can use the discrete logarithm problem to our advantage.
<strong>It is very easy to compute $kG$ given $k$ and $G$</strong>.
But it is <strong>hard as fuck to find $k$ given $kG$ and $G$</strong>.</p><h2 id=the-secp256k1-elliptic-curve>The <code>secp256k1</code> Elliptic Curve<a hidden class=anchor aria-hidden=true href=#the-secp256k1-elliptic-curve>#</a></h2><p>Let&rsquo;s talk about some facts<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup> about our muse <code>secp256k1</code> elliptic curve:</p><ul><li><strong>Equation</strong>: $y^2 = x^3 + 7$</li><li><strong>$\mathbb{F}_p$ where $p$</strong>: $2^{256} - 2^{32} - 2^9 - 2^8 - 2^7 - 2^6 - 2^4 - 1$ (yes, it is a prime number)</li><li><strong>Order $n$</strong>: this is the number of possible points in the curve<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>, 0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup></li><li><strong>Generator Point $G$</strong>: (0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798, 0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8)<sup id=fnref1:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup></li></ul><h2 id=license>License<a hidden class=anchor aria-hidden=true href=#license>#</a></h2><p>This post is licensed under <a href=http://creativecommons.org/licenses/by-nc-sa/4.0/>Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International</a>.</p><p><a href=http://creativecommons.org/licenses/by-nc-sa/4.0/><img loading=lazy src=https://licensebuttons.net/l/by-nc-sa/4.0/88x31.png alt="CC BY-NC-SA 4.0"></a></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>This is also why transaction malleability was a problem before Segwit in Bitcoin.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>If the line is vertical or tangent to the curve,
then it intersects the curve in a point at infinity.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>These are standard and defined in the <a href=https://www.secg.org/>Standards for Efficient Cryptography Group</a>
in their <a href=https://www.secg.org/sec2-v2.pdf>SEC 2 specification</a>.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>To find the order of an elliptic curve, you can use <a href=https://en.wikipedia.org/wiki/Schoof%27s_algorithm#The_algorithm>Schoof&rsquo;s algorithm</a>.&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p>It is a fucking big number, so I am putting the values in hexadecimal representation.&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref1:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://realeinherjar.github.io/tags/cryptography/>cryptography</a></li><li><a href=https://realeinherjar.github.io/tags/bitcoin/>bitcoin</a></li></ul><nav class=paginav><a class=prev href=https://realeinherjar.github.io/2023-09-08-taproot/><span class=title>« Prev</span><br><span>Taproot Basics</span></a></nav></footer></article></main><footer class=footer><span><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></span>
<span>- Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer">Hugo</a> &
        <a href=https://github.com/Wonderfall/hugo-WonderMod/ rel=noopener>WonderMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script defer crossorigin=anonymous src=/assets/js/papermod.7ea300eda6d3653624a576fbc095ccd8a0c2977756acbe5de4114132a72cc7fa.js integrity="sha256-fqMA7abTZTYkpXb7wJXM2KDCl3dWrL5d5BFBMqcsx/o="></script></body></html>